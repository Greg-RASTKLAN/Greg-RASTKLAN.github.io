<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>My Socials</title>

  <style>
    /* On cache l'input sans display:none pour que l'événement fonctionne */
    #heart {
      opacity: 0;
      position: absolute;
      left: -9999px;
    }

    .like-button {
      position: relative;
      cursor: pointer;
      display: flex;
      height: 48px;
      width: 136px;
      border-radius: 16px;
      border: none;
      background-color: #3a3a3a;
      overflow: hidden;
      align-items: center;
      justify-content: space-between;
      padding: 0 10px;
    }

    .like {
      display: flex;
      align-items: center;
      cursor: pointer;
    }

    .like-icon {
      fill: #505050;
      height: 28px;
      width: 28px;
      margin-right: 8px;
      transition: fill 0.2s ease-out, transform 0.2s ease-out;
    }

    .like-text {
      color: #fcfcfc;
      font-size: 16px;
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
    }

    .like-count {
      color: #717070;
      font-size: 16px;
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      transition: all 0.3s ease-out;
    }

    .on:checked + label .like-icon {
      fill: #fc4e4e;
      transform: scale(1.2);
    }

    .on:checked ~ .like-count {
      color: #fcfcfc;
    }
  </style>
</head>
<body>
  <div class="like-button">
    <input class="on" id="heart" type="checkbox" />
    <label class="like" for="heart">
      <svg class="like-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path d="m11.645 20.91-.007-.003-.022-.012a15.247 15.247 0 0 1-.383-.218 25.18 25.18 0 0 1-4.244-3.17C4.688 15.36 2.25 12.174 2.25 8.25 2.25 5.322 4.714 3 7.688 3A5.5 5.5 0 0 1 12 5.052 5.5 5.5 0 0 1 16.313 3c2.973 0 5.437 2.322 5.437 5.25 0 3.925-2.438 7.111-4.739 9.256a25.175 25.175 0 0 1-4.244 3.17 15.247 15.247 0 0 1-.383.219l-.022.012-.007.004-.003.001a.752.752 0 0 1-.704 0l-.003-.001Z"/>
      </svg>
      <span class="like-text">Likes</span>
    </label>
    <span class="like-count">0</span>
  </div>

  <script>
    const heart = document.getElementById("heart");
    const likeCount = document.querySelector(".like-count");
    const API_URL = "https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec"; // <- remplace par ton URL

    // Fonction pour récupérer le compteur
    function loadLikes() {
      fetch(API_URL)
        .then(res => res.json())
        .then(data => {
          console.log("GET response:", data);
          if (data.count !== undefined) {
            likeCount.textContent = data.count;
          } else {
            likeCount.textContent = 0;
          }
        })
        .catch(err => console.error("Erreur GET:", err));
    }

    // Charger le compteur au chargement
    loadLikes();

    // Poster un like
    heart.addEventListener("change", () => {
      if (heart.checked) {
        fetch(API_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ like: 1 })
        })
        .then(res => res.json())
        .then(data => {
          console.log("POST response:", data);
          if (data.count !== undefined) {
            likeCount.textContent = data.count;
          }
        })
        .catch(err => console.error("Erreur POST:", err));
      }
    });
  </script>
</body>
</html>
